/*! For license information please see jquery.shuffle.min.js.LICENSE.txt */
!function(t){"function"==typeof define&&define.amd?define(["jquery","modernizr"],t):"object"==typeof exports?module.exports=t(require("jquery"),window.Modernizr):window.Shuffle=t(window.jQuery,window.Modernizr)}((function(t,e,i){"use strict";function s(t,e,i){for(var s=0,n=t.length;n>s;s++)if(e.call(i,t[s],s,t)==={})return}function n(e,i,s){return setTimeout(t.proxy(e,i),s)}function o(t){return Math.max.apply(Math,t)}function r(e){return t.isNumeric(e)?e:0}if("object"!=typeof e)throw new Error("Shuffle.js requires Modernizr.\nhttp://vestride.github.io/Shuffle/#dependencies");var a=e.prefixed("transition"),l=e.prefixed("transitionDelay"),h=e.prefixed("transitionDuration"),u={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[a],p=e.prefixed("transform"),d=function(t){return t?t.replace(/([A-Z])/g,(function(t,e){return"-"+e.toLowerCase()})).replace(/^ms-/,"-ms-"):""}(p),c=e.csstransforms&&e.csstransitions,f=e.csstransforms3d,m=!!window.getComputedStyle,y="shuffle",_="all",g=.001,v=window.getComputedStyle||function(){},C=function(t,e){this.x=r(t),this.y=r(e)};C.equals=function(t,e){return t.x===e.x&&t.y===e.y};var T=function(){if(!m)return!1;var t=document.body||document.documentElement,e=document.createElement("div");e.style.cssText="width:10px;padding:2px;-webkit-box-sizing:border-box;box-sizing:border-box;",t.appendChild(e);var i="10px"===v(e,null).width;return t.removeChild(e),i}(),S=0,F=t(window),b=function(e,i){i=i||{},t.extend(this,b.options,i,b.settings),this.$el=t(e),this.element=e,this.unique="shuffle_"+S++,this._fire(b.EventType.LOADING),this._init(),n((function(){this.initialized=!0,this._fire(b.EventType.DONE)}),this,16)};return b.EventType={LOADING:"loading",DONE:"done",LAYOUT:"layout",REMOVED:"removed"},b.ClassName={BASE:y,SHUFFLE_ITEM:"shuffle-item",FILTERED:"filtered",CONCEALED:"concealed"},b.options={group:_,speed:250,easing:"ease-out",itemSelector:"",sizer:null,gutterWidth:0,columnWidth:0,delimeter:null,buffer:0,columnThreshold:m?.01:.1,initialSort:null,throttle:function(e,i,s){var n,o,r,a=null,l=0;s=s||{};var h=function(){l=!1===s.leading?0:t.now(),a=null,r=e.apply(n,o),n=o=null};return function(){var u=t.now();l||!1!==s.leading||(l=u);var p=i-(u-l);return n=this,o=arguments,0>=p||p>i?(clearTimeout(a),a=null,l=u,r=e.apply(n,o),n=o=null):a||!1===s.trailing||(a=setTimeout(h,p)),r}},throttleTime:300,sequentialFadeDelay:150,supported:c},b.settings={useSizer:!1,itemCss:{position:"absolute",top:0,left:0,visibility:"visible"},revealAppendedDelay:300,lastSort:{},lastFilter:_,enabled:!0,destroyed:!1,initialized:!1,_animations:[],_transitions:[],_isMovementCanceled:!1,styleQueue:[]},b.Point=C,b._getItemTransformString=function(t,e){return f?"translate3d("+t.x+"px, "+t.y+"px, 0) scale3d("+e+", "+e+", 1)":"translate("+t.x+"px, "+t.y+"px) scale("+e+")"},b._getNumberStyle=function(e,i,s){if(m){s=s||v(e,null);var n=b._getFloat(s[i]);return T||"width"!==i?T||"height"!==i||(n+=b._getFloat(s.paddingTop)+b._getFloat(s.paddingBottom)+b._getFloat(s.borderTopWidth)+b._getFloat(s.borderBottomWidth)):n+=b._getFloat(s.paddingLeft)+b._getFloat(s.paddingRight)+b._getFloat(s.borderLeftWidth)+b._getFloat(s.borderRightWidth),n}return b._getFloat(t(e).css(i))},b._getFloat=function(t){return r(parseFloat(t))},b._getOuterWidth=function(t,e){var i=v(t,null),s=b._getNumberStyle(t,"width",i);return e&&(s+=b._getNumberStyle(t,"marginLeft",i)+b._getNumberStyle(t,"marginRight",i)),s},b._getOuterHeight=function(t,e){var i=v(t,null),s=b._getNumberStyle(t,"height",i);return e&&(s+=b._getNumberStyle(t,"marginTop",i)+b._getNumberStyle(t,"marginBottom",i)),s},b._skipTransition=function(t,e,i){var s=t.style[h];t.style[h]="0ms",e.call(i),t.offsetWidth,t.style[h]=s},b.prototype._init=function(){this.$items=this._getItems(),this.sizer=this._getElementOption(this.sizer),this.sizer&&(this.useSizer=!0),this.$el.addClass(b.ClassName.BASE),this._initItems(),F.on("resize."+y+"."+this.unique,this._getResizeFunction());var t=this.$el.css(["position","overflow"]),e=b._getOuterWidth(this.element);this._validateStyles(t),this._setColumns(e),this.shuffle(this.group,this.initialSort),this.supported&&n((function(){this._setTransitions(),this.element.style[a]="height "+this.speed+"ms "+this.easing}),this)},b.prototype._getResizeFunction=function(){var e=t.proxy(this._onResize,this);return this.throttle?this.throttle(e,this.throttleTime):e},b.prototype._getElementOption=function(t){return"string"==typeof t?this.$el.find(t)[0]||null:t&&t.nodeType&&1===t.nodeType?t:t&&t.jquery?t[0]:null},b.prototype._validateStyles=function(t){"static"===t.position&&(this.element.style.position="relative"),"hidden"!==t.overflow&&(this.element.style.overflow="hidden")},b.prototype._filter=function(t,e){t=t||this.lastFilter,e=e||this.$items;var i=this._getFilteredSets(t,e);return this._toggleFilterClasses(i.filtered,i.concealed),this.lastFilter=t,"string"==typeof t&&(this.group=t),i.filtered},b.prototype._getFilteredSets=function(e,i){var n=t(),o=t();return e===_?n=i:s(i,(function(i){var s=t(i);this._doesPassFilter(e,s)?n=n.add(s):o=o.add(s)}),this),{filtered:n,concealed:o}},b.prototype._doesPassFilter=function(e,i){if(t.isFunction(e))return e.call(i[0],i,this);var s=i.data("groups"),n=this.delimeter&&!t.isArray(s)?s.split(this.delimeter):s;return t.inArray(e,n)>-1},b.prototype._toggleFilterClasses=function(t,e){t.removeClass(b.ClassName.CONCEALED).addClass(b.ClassName.FILTERED),e.removeClass(b.ClassName.FILTERED).addClass(b.ClassName.CONCEALED)},b.prototype._initItems=function(t){(t=t||this.$items).addClass([b.ClassName.SHUFFLE_ITEM,b.ClassName.FILTERED].join(" ")),t.css(this.itemCss).data("point",new C).data("scale",1)},b.prototype._updateItemCount=function(){this.visibleItems=this._getFilteredItems().length},b.prototype._setTransition=function(t){t.style[a]=d+" "+this.speed+"ms "+this.easing+", opacity "+this.speed+"ms "+this.easing},b.prototype._setTransitions=function(t){s(t=t||this.$items,(function(t){this._setTransition(t)}),this)},b.prototype._setSequentialDelay=function(t){this.supported&&s(t,(function(t,e){t.style[l]="0ms,"+(e+1)*this.sequentialFadeDelay+"ms"}),this)},b.prototype._getItems=function(){return this.$el.children(this.itemSelector)},b.prototype._getFilteredItems=function(){return this.$items.filter("."+b.ClassName.FILTERED)},b.prototype._getConcealedItems=function(){return this.$items.filter("."+b.ClassName.CONCEALED)},b.prototype._getColumnSize=function(e,i){var s;return 0===(s=t.isFunction(this.columnWidth)?this.columnWidth(e):this.useSizer?b._getOuterWidth(this.sizer):this.columnWidth?this.columnWidth:this.$items.length>0?b._getOuterWidth(this.$items[0],!0):e)&&(s=e),s+i},b.prototype._getGutterSize=function(e){return t.isFunction(this.gutterWidth)?this.gutterWidth(e):this.useSizer?b._getNumberStyle(this.sizer,"marginLeft"):this.gutterWidth},b.prototype._setColumns=function(t){var e=t||b._getOuterWidth(this.element),i=this._getGutterSize(e),s=this._getColumnSize(e,i),n=(e+i)/s;Math.abs(Math.round(n)-n)<this.columnThreshold&&(n=Math.round(n)),this.cols=Math.max(Math.floor(n),1),this.containerWidth=e,this.colWidth=s},b.prototype._setContainerSize=function(){this.$el.css("height",this._getContainerSize())},b.prototype._getContainerSize=function(){return o(this.positions)},b.prototype._fire=function(t,e){this.$el.trigger(t+"."+y,e&&e.length?e:[this])},b.prototype._resetCols=function(){var t=this.cols;for(this.positions=[];t--;)this.positions.push(0)},b.prototype._layout=function(t,e){s(t,(function(t){this._layoutItem(t,!!e)}),this),this._processStyleQueue(),this._setContainerSize()},b.prototype._layoutItem=function(e,i){var s=t(e),n=s.data(),o=n.point,r=n.scale,a={width:b._getOuterWidth(e,!0),height:b._getOuterHeight(e,!0)},l=this._getItemPosition(a);C.equals(o,l)&&1===r||(n.point=l,n.scale=1,this.styleQueue.push({$item:s,point:l,scale:1,opacity:i?0:1,skipTransition:i||0===this.speed,callfront:function(){i||s.css("visibility","visible")},callback:function(){i&&s.css("visibility","hidden")}}))},b.prototype._getItemPosition=function(t){for(var e=this._getColumnSpan(t.width,this.colWidth,this.cols),i=this._getColumnSet(e,this.cols),s=this._getShortColumn(i,this.buffer),n=new C(Math.round(this.colWidth*s),Math.round(i[s])),o=i[s]+t.height,r=this.cols+1-i.length,a=0;r>a;a++)this.positions[s+a]=o;return n},b.prototype._getColumnSpan=function(t,e,i){var s=t/e;return Math.abs(Math.round(s)-s)<this.columnThreshold&&(s=Math.round(s)),Math.min(Math.ceil(s),i)},b.prototype._getColumnSet=function(t,e){if(1===t)return this.positions;for(var i=e+1-t,s=[],n=0;i>n;n++)s[n]=o(this.positions.slice(n,n+t));return s},b.prototype._getShortColumn=function(t,e){for(var i=function(t){return Math.min.apply(Math,t)}(t),s=0,n=t.length;n>s;s++)if(t[s]>=i-e&&t[s]<=i+e)return s;return 0},b.prototype._shrink=function(e){s(e||this._getConcealedItems(),(function(e){var i=t(e),s=i.data();s.scale!==g&&(s.scale=g,this.styleQueue.push({$item:i,point:s.point,scale:g,opacity:0,callback:function(){i.css("visibility","hidden")}}))}),this)},b.prototype._onResize=function(){this.enabled&&!this.destroyed&&b._getOuterWidth(this.element)!==this.containerWidth&&this.update()},b.prototype._getStylesForTransition=function(t){var e={opacity:t.opacity};return this.supported?e[p]=b._getItemTransformString(t.point,t.scale):(e.left=t.point.x,e.top=t.point.y),e},b.prototype._transition=function(e){var i=this._getStylesForTransition(e);this._startItemAnimation(e.$item,i,e.callfront||t.noop,e.callback||t.noop)},b.prototype._startItemAnimation=function(e,i,s,n){function o(e){e.target===e.currentTarget&&(t(e.target).off(u,o),r._removeTransitionReference(a),n())}var r=this,a={$element:e,handler:o};if(s(),!this.initialized)return e.css(i),void n();if(this.supported)e.css(i),e.on(u,o),this._transitions.push(a);else{var l=e.stop(!0).animate(i,this.speed,"swing",n);this._animations.push(l.promise())}},b.prototype._processStyleQueue=function(e){this.isTransitioning&&this._cancelMovement();var i=t();s(this.styleQueue,(function(t){t.skipTransition?this._styleImmediately(t):(i=i.add(t.$item),this._transition(t))}),this),i.length>0&&this.initialized&&this.speed>0?(this.isTransitioning=!0,this.supported?this._whenCollectionDone(i,u,this._movementFinished):this._whenAnimationsDone(this._movementFinished)):e||n(this._layoutEnd,this),this.styleQueue.length=0},b.prototype._cancelMovement=function(){this.supported?s(this._transitions,(function(t){t.$element.off(u,t.handler)})):(this._isMovementCanceled=!0,this.$items.stop(!0),this._isMovementCanceled=!1),this._transitions.length=0,this.isTransitioning=!1},b.prototype._removeTransitionReference=function(e){var i=t.inArray(e,this._transitions);i>-1&&this._transitions.splice(i,1)},b.prototype._styleImmediately=function(t){b._skipTransition(t.$item[0],(function(){t.$item.css(this._getStylesForTransition(t))}),this)},b.prototype._movementFinished=function(){this.isTransitioning=!1,this._layoutEnd()},b.prototype._layoutEnd=function(){this._fire(b.EventType.LAYOUT)},b.prototype._addItems=function(t,e,i){this._initItems(t),this._setTransitions(t),this.$items=this._getItems(),this._shrink(t),s(this.styleQueue,(function(t){t.skipTransition=!0})),this._processStyleQueue(!0),e?this._addItemsToEnd(t,i):this.shuffle(this.lastFilter)},b.prototype._addItemsToEnd=function(t,e){var i=this._filter(null,t).get();this._updateItemCount(),this._layout(i,!0),e&&this.supported&&this._setSequentialDelay(i),this._revealAppended(i)},b.prototype._revealAppended=function(e){n((function(){s(e,(function(e){var i=t(e);this._transition({$item:i,opacity:1,point:i.data("point"),scale:1})}),this),this._whenCollectionDone(t(e),u,(function(){t(e).css(l,"0ms"),this._movementFinished()}))}),this,this.revealAppendedDelay)},b.prototype._whenCollectionDone=function(e,i,s){function n(e){e.target===e.currentTarget&&(t(e.target).off(i,n),++o===r&&(a._removeTransitionReference(l),s.call(a)))}var o=0,r=e.length,a=this,l={$element:e,handler:n};e.on(i,n),this._transitions.push(l)},b.prototype._whenAnimationsDone=function(e){t.when.apply(null,this._animations).always(t.proxy((function(){this._animations.length=0,this._isMovementCanceled||e.call(this)}),this))},b.prototype.shuffle=function(t,e){this.enabled&&(t||(t=_),this._filter(t),this._updateItemCount(),this._shrink(),this.sort(e))},b.prototype.sort=function(t){if(this.enabled){this._resetCols();var e=t||this.lastSort,i=this._getFilteredItems().sorted(e);this._layout(i),this.lastSort=e}},b.prototype.update=function(t){this.enabled&&(t||this._setColumns(),this.sort())},b.prototype.layout=function(){this.update(!0)},b.prototype.appended=function(t,e,i){this._addItems(t,!0===e,!1!==i)},b.prototype.disable=function(){this.enabled=!1},b.prototype.enable=function(t){this.enabled=!0,!1!==t&&this.update()},b.prototype.remove=function(e){e.length&&e.jquery&&(this._toggleFilterClasses(t(),e),this._shrink(e),this.sort(),this.$el.one(b.EventType.LAYOUT+"."+y,t.proxy((function(){e.remove(),this.$items=this._getItems(),this._updateItemCount(),this._fire(b.EventType.REMOVED,[e,this]),e=null}),this)))},b.prototype.destroy=function(){F.off("."+this.unique),this.$el.removeClass(y).removeAttr("style").removeData(y),this.$items.removeAttr("style").removeData("point").removeData("scale").removeClass([b.ClassName.CONCEALED,b.ClassName.FILTERED,b.ClassName.SHUFFLE_ITEM].join(" ")),this.$items=null,this.$el=null,this.sizer=null,this.element=null,this._transitions=null,this.destroyed=!0},t.fn.shuffle=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each((function(){var s=t(this),n=s.data(y);n?"string"==typeof e&&n[e]&&n[e].apply(n,i):(n=new b(this,e),s.data(y,n))}))},t.fn.sorted=function(e){var s=t.extend({},t.fn.sorted.defaults,e),n=this.get(),o=!1;return n.length?s.randomize?function(t){var e,i,s=t.length;if(!s)return t;for(;--s;)e=t[i=Math.floor(Math.random()*(s+1))],t[i]=t[s],t[s]=e;return t}(n):(t.isFunction(s.by)&&n.sort((function(e,n){if(o)return 0;var r=s.by(t(e)),a=s.by(t(n));return r===i&&a===i?(o=!0,0):a>r||"sortFirst"===r||"sortLast"===a?-1:r>a||"sortLast"===r||"sortFirst"===a?1:0})),o?this.get():(s.reverse&&n.reverse(),n)):[]},t.fn.sorted.defaults={reverse:!1,by:null,randomize:!1},b}));